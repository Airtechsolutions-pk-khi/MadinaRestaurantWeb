
@{
    ViewBag.Title = "Shop";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<head>
    <style>
        .single-item-wrap .wrap-details {
            margin-top: 35px !important;
        }

        .single-item-wrap .thumb {
            text-align: center;
            padding-left: 20px;
        }

        #a {
            display: none;
        }
        .single-item-wrap .thumb a {
            position: relative;
            top: 18px;
            right: 27px;
            font-size: 24px;
        }
        label:hover {
            color: #fff;
            background-color: yellowgreen;
            border-radius:40px;
            width:230px;
        }
    </style>
</head>
<!-- bredcrumb Area Start-->
<section class="breadcrumb-area">
    <div class="banner-bg-img"></div>
    <div class="banner-shape-1"><img src="~/assets/img/banner/shape-1.png" alt="img"></div>
    <div class="banner-shape-2"><img src="~/assets/img/banner/shape-2.png" alt="img"></div>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6 align-self-center">
                <div class="banner-inner text-center">
                    <h3>
                        Choose you items
                    </h3>
                    <h1>SHOP PAGE</h1>
                    <nav aria-label="breadcrumb">
                        <ul class="breadcrumb">
                            <li class="breadcrumb-item"><a href="home.html">Home</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Shop</li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- breadcrumb Area End -->
<!-- shop Area Start-->
<section class="shop-area pd-top-120 pd-bottom-120">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="row justify-content-center">
                    <div class="col-sm-6 align-self-center pb-4">
                        @*<p class="mb-0">Showing 1–8 of 12 results</p>*@
                    </div>
                    <div class="col-sm-6 align-self-center pb-4">
                        @*<select class="single-select float-sm-end">
                                <option>Default sorting</option>
                                <option value="asc">Pizza</option>
                                <option value="desc">Burger</option>
                                <option value="pop">Ramen</option>
                            </select>*@
                    </div>
                    <div class="tab-content" id="pills-tabContent">

                    </div>

                    @foreach (var item in ViewBag.BestProduct)
                    {
                        <div class="col-md-4 hideDiv">
                            <div class="single-item-wrap">
                                <div class="thumb">

                                    <a href="@Url.Action("ProductDetails", "Product", new { ItemID = item.ItemID })"><img src="@System.Configuration.ConfigurationManager.AppSettings["Image"].ToString()@item.Image" alt="@item.Name"></a>
                                    <a class="fav-btn" href="#"><i class="ri-heart-line"></i></a>
                                </div>
                                
                                <div class="wrap-details">
                                    <h5><a href="@Url.Action("ProductDetails", "Product", new { ItemID = item.ItemID })">@item.Name</a></h5>
                                    <div class="wrap-footer">
                                        
                                        <h6 class="price" style="font-size:18px;">Rs. @item.Price</h6>
                                    </div>
                                </div>
                                <div class="btn-area">

                                    <a class="btn btn-secondary" href="@Url.Action("ProductDetails", "Product", new { ItemID = item.ItemID })">Add to Cart</a>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>
            <div class="col-lg-4 order-lg-first">
                <div class="sidebar-area">
                    <div class="widget widget_search">
                        <div class="input-group input-group-sm my-4">
                            <input type="text" id="txt-mobile" class="form-control " placeholder="Search" aria-label="Search" aria-describedby="basic-addon2">
                            <div class="input-group-append">
                                <a href="javascript:;" class="filterOn btn btn-default btn-small">Search</a>
                            </div>
                        </div>

                        @*<form class="search-form">
                        <div class="form-group">
                            <input type="text" id="txt-mobile" placeholder="Search your itmes">
                        </div>                        
                        <button class="submit-btn" type="submit"><i class="ri-search-line"></i></button>
                        </form>*@
                    </div>
                    <div class="widget widget_categories style-2">
                        <h4 class="widget-title" style="color:var(--heading-color);">Categories</h4>
                        <ul>
                            @foreach (var item in ViewBag.Category)
                            {
                                <li>
                                    <label class=" form-check-label">
                                        @*@if (@item.Image != null)
                                        {
                                            <i><img src="@System.Configuration.ConfigurationManager.AppSettings["Image"].ToString()@item.Image" alt="@item.Name"></i>
                                        }
                                        else
                                        {*@                                            
                                            <i><img src="~/assets/img/category/categoryNA.png" style="width:60px;height:60px;border-radius:30px;"></i>
                                        @*}*@

                                        <input type="checkbox" name="Category" id="a" value="@item.CategoryID" class="form-check-input " autocomplete="off"> @item.Name

                                    </label>
                                </li>

                            }

                        </ul>
                    </div>
                  
                    <div class="widget widget-recent-post style-2">
                        <h4 class="widget-title" style="color:var(--heading-color);">Today’s Special</h4>
                        <ul>
                            @foreach (var item in ViewBag.TodaysSpecial)
                            {


                                <li>
                                    <div class="media">
                                        <div class="media-left">
                                            <img src="@System.Configuration.ConfigurationManager.AppSettings["Image"].ToString()@item.Image" alt="Image" style="width:80px;height:80px;">
                                        </div>
                                        <div class="media-body">
                                            <h6 class="title"><a href="#">@item.Name</a></h6>
                                            @*<div class="rating">
                                                    4.9
                                                    <span class="rating-inner">
                                                        <i class="ri-star-fill ps-0"></i>
                                                        <i class="ri-star-fill"></i>
                                                        <i class="ri-star-fill"></i>
                                                        <i class="ri-star-fill"></i>
                                                        <i class="ri-star-half-line pe-0"></i>
                                                    </span>
                                                    (462)
                                                </div>*@
                                            <h6 class="price">Rs. @item.Price</h6>
                                        </div>
                                    </div>
                                </li>
                            }

                        </ul>
                    </div>

                </div>
            </div>
            @*<div class="col-12">
                    <nav class="text-end">
                        <ul class="pagination">
                            <li class="page-item">
                                <a class="page-link" href="#">
                                    <i class="ri-arrow-left-s-line"></i>
                                </a>
                            </li>
                            <li class="page-item active"><a class="page-link" href="#">1</a></li>
                            <li class="page-item"><a class="page-link" href="#">2</a></li>
                            <li class="page-item"><a class="page-link" href="#">3</a></li>
                            <li class="page-item">
                                <a class="page-link" href="#">
                                    <i class="ri-arrow-right-s-line"></i>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>*@
        </div>
    </div>
</section>
<!-- shop Area End -->
<script>
     
      $(document).ready(function () {

          $("#pills-tabContent").load('@Url.Action("Products", "Shop")');
          //$(".hideDiv").hide();

            var Category = [];
            

            $('input[name="Category"]').click(function () {

                if ($(this).prop("checked") == true) {
                    Category.push($(this).val());
                    
                    ProductFilter(Category.join());
                }
                else {
                    var index = Category.indexOf($(this).val());
                    Category.splice(index, 1);
                     
                    ProductFilter(Category.join());
                }
            });

          
            $(".filterOn").click(function () {

                $("#divLoader").show();
                $("#pills-tabContent").hide();
                //$(".hideDiv").hide();

                var Searchtxt = "";

                if ($("#txt-desktop").val() != null && $("#txt-desktop").val() != '') {
                    Searchtxt = $("#txt-desktop").val();
                }
                else {
                    Searchtxt = $("#txt-mobile").val();
                }

               
                var filter = new Object();
                filter.Category = Category.join();                              
                filter.Searchtxt = Searchtxt;
                

                var FilterData = JSON.stringify(filter);

                $.ajax({
                    type: "POST",
                    url: '../Shop/Filter',
                    data: FilterData,
                    contentType: 'application/json; charset=utf-8',
                    dataType: 'json',
                    success: function (obj) {
                        debugger
                        $.ajax({
                            type: "POST",
                            url: '../Shop/Products',
                            data: JSON.stringify(obj.data),
                            contentType: 'application/json; charset=utf-8',
                            dataType: 'json',
                            success: function (data) {
                                debugger
                                alert(data)
                                $(".hideDiv").hide();
                                $("#pills-tabContent").show();
                                $("#pills-tabContent").html(data);

                            },
                            error: function (xhr, textStatus, errorThrown) {

                            }
                        });
                    },
                    error: function (xhr, textStatus, errorThrown) {
                        //
                    }
                });
            });
            //===============================================

        });
        function ProductFilter(Category) {
            debugger
            $("#divLoader").show();
            $("#pills-tabContent").hide();

          
            var filter = new Object();
            filter.Category = Category;
          
            filter.Searchtxt = "";
           

            var FilterData = JSON.stringify(filter);

            $.ajax({
                type: "POST",
                url: '../Shop/Filter',
                data: FilterData,
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (obj) {
                    $.ajax({
                        type: "POST",
                        url: '../Shop/Products',
                        data: JSON.stringify(obj.data),
                        contentType: 'application/json; charset=utf-8',
                        dataType: 'html',
                        success: function (data) {
                            debugger
                            alert(data)
                            $(".hideDiv").hide();
                             $("#pills-tabContent").show();
                             $("#pills-tabContent").html(data);

                        },
                        error: function (xhr, textStatus, errorThrown) {

                        }
                    });
                },
                error: function (xhr, textStatus, errorThrown) {
                    //
                }
            });
        }
     
    //var Category = [];

    //$('input[name="Category"]').click(function () {

    //    if ($(this).prop("checked") == true) {
    //        $('.hideDiv').hide();
    //        Category.push($(this).val());

    //        ProductFilter(Category.join());
    //    }
    //    else {
    //        $('.hideDiv').show();
    //        var index = Category.indexOf($(this).val());
    //        Category.splice(index, 1);

    //        ProductFilter(Category.join());
    //    }
    //});


    //function ProductFilter(Category, Searchtxt) {
    //    $("#divLoader").show();
    //    $("#pills-tabContent").hide();

    //    var filter = new Object();
    //    filter.Category = Category;

    //    var FilterData = JSON.stringify(filter);
    //    $.ajax({
    //        type: "POST",
    //        url: '../Home/Filter',
    //        data: FilterData,
    //        contentType: 'application/json; charset=utf-8',
    //        dataType: 'json',
    //        success: function (obj) {
    //            $.ajax({
    //                type: "POST",
    //                url: '../Home/Products',
    //                data: JSON.stringify(obj.data),
    //                contentType: 'application/json; charset=utf-8',
    //                dataType: 'html',
    //                success: function (data) {

    //                    $("#divLoader").hide();
    //                    $("#pills-tabContent").show();
    //                    $("#pills-tabContent").html(data);

    //                },
    //                error: function (xhr, textStatus, errorThrown) {

    //                }
    //            });
    //        },
    //        error: function (xhr, textStatus, errorThrown) {
    //            //
    //        }
    //    });
    //    }
    //});
</script>